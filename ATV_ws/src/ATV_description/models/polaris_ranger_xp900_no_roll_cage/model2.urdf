<?xml version="1.0" ?>
<robot name="polaris_ranger_xp900">

  <link name="base_link"/>

  <joint name="base_joint" type="fixed">
    <parent link="base_link"/>
    <child link="chassis"/>
  </joint>

  <joint name="left_steering_joint" type="revolute">
    <parent link="chassis"/>
    <child link="fl_steering_block"/>
    <origin rpy="1.57079  0       0" xyz="1.20222  0.5      0.35515"/>
    <axis xyz="0  1  0"/>
    <limit effort="1000.0" lower="-0.7727" upper="0.7727" velocity="1.0"/>
  </joint>

  <joint name="left_front_axle" type="continuous"> 
    <parent link="fl_steering_block"/>
    <child link="left_front_wheel"/>
    <origin rpy="-3.09079  0       0" xyz="0      -0.00818 -0.21562"/>
    <axis xyz="0.00000000e+00   8.30000000e-04   1.00000000e+00"/>
    <limit effort="0" lower="0" upper="0" velocity="0"/>
  </joint>

  <joint name="right_steering_joint" type="revolute">
    <parent link="chassis"/>
    <child link="fr_steering_block"/>
    <origin rpy="1.57079  0       0" xyz="1.20222 -0.5      0.35515"/>
    <axis xyz="0  1  0"/>
    <limit effort="1000.0" lower="-0.7727" upper="0.7727" velocity="1.0"/>
  </joint>

  <joint name="right_front_axle" type="continuous">
    <parent link="fr_steering_block"/>
    <child link="right_front_wheel"/>
    <origin rpy="-0.05079  0       0" xyz="0      -0.00818  0.21562"/>
    <axis xyz="0.00000000e+00   8.30000000e-04  -1.00000000e+00"/>
    <limit effort="0" lower="0" upper="0" velocity="0"/>
  </joint>

  <joint name="left_rear_axle" type="continuous">
    <parent link="chassis"/>
    <child link="left_rear_wheel"/>
    <origin rpy="-1.52  0    0" xyz="-0.99377  0.71562  0.34697"/>
    <axis xyz="0.00000000e+00   8.30000000e-04   1.00000000e+00"/>
    <limit effort="100" lower="-100" upper="100" velocity="100.0"/>
  </joint>

  <joint name="right_rear_axle" type="continuous">
    <parent link="chassis"/>
    <child link="right_rear_wheel"/>
    <origin rpy="1.52  0    0" xyz="-0.99377 -0.61574  0.34189"/>
    <axis xyz="0.00000000e+00   8.30000000e-04  -1.00000000e+00"/>
    <limit effort="100" lower="-100" upper="100" velocity="100.0"/>
  </joint>

  <!--
  <joint name="steering_joint" type="fixed">
    <parent link="chassis"/>
    <child link="steering_wheel"/>
    <origin rpy="0   -0.87  0" xyz="0.42  0.46  1.2"/>
    <axis xyz="0  0  1"/>
    <limit effort="0.0" lower="-3.14" upper="3.14" velocity="0.0"/>
  </joint>-->
  
  <link name="chassis">
    <parent link="base_link"/>
    <origin rpy="0   0    0" xyz="-0.99377  0.71562  0.34697"/>
    <inertial>
      <mass value="720.0"/>
      <origin rpy="0  0  0" xyz="0.1  0   0.4"/>
      <inertia ixx="140" ixy="0.0" ixz="0.0" iyy="550" iyz="0.0" izz="550"/>
    </inertial>
    <collision name="chassis_bottom">
      <origin rpy="0  0  0" xyz="0.2    0     0.335"/>
      <geometry>
        <box size="1.34 1.65746 0.06"/>
      </geometry>
    </collision>
    <collision name="cargo_bottom">
      <origin rpy="0  0  0" xyz="-1     0     0.921"/>
      <geometry>
        <box size="1.04609 1.6998 0.01"/>
      </geometry>
    </collision>
    <collision name="cargo_front">
      <origin rpy="0  0  0" xyz="-0.495  0     1.06"/>
      <geometry>
        <box size="0.05 1.69982 0.27"/>
      </geometry>
    </collision>
    <collision name="cargo_back">
      <origin rpy="0  0  0" xyz="-1.465  0     1.06"/>
      <geometry>
        <box size="0.05 1.69982 0.27"/>
      </geometry>
    </collision>
    <collision name="cargo_left">
      <origin rpy="0  0  0" xyz="-0.97     0.82491  1.06"/>
      <geometry>
        <box size="1.04609 0.05 0.27"/>
      </geometry>
    </collision>
    <collision name="cargo_right">
      <origin rpy="0  0  0" xyz="-0.97    -0.82491  1.06"/>
      <geometry>
        <box size="1.04609 0.05 0.27"/>
      </geometry>
    </collision>
    <collision name="seat">
      <origin rpy="0  0  0" xyz="0    0    0.62"/>
      <geometry>
        <box size="0.52167 1.37206 0.53369"/>
      </geometry>
    </collision>
    <collision name="mud_seat">
      <origin rpy="0  0  0" xyz="0    0    0.86"/>
      <geometry>
        <box size="0.52167 1.30 0.1"/>
      </geometry>
    </collision>
    <collision name="seat_back">
      <origin rpy="0  -0.2  0" xyz="-0.26   0     1.125"/>
      <geometry>
        <box size="0.06 1.37206 0.6"/>
      </geometry>
    </collision>
    <collision name="engine">
      <origin rpy="0  0  0" xyz="1.12  0    0.7"/>
      <geometry>
        <box size="0.58 1.3 0.8"/>
      </geometry>
    </collision>
    <collision name="central_hump1_collision">
      <origin rpy="0  0  0" xyz="0.55 -0.1   0.4"/>
      <geometry>
        <box size="0.6 0.15 0.1"/>
      </geometry>
    </collision>
    <collision name="central_hump2_collision">
      <origin rpy="0  -0.5  0" xyz="0.7  -0.05  0.45"/>
      <geometry>
        <box size="0.20 0.05 0.1"/>
      </geometry>
    </collision>
    <collision name="central_hump3_collision">
      <origin rpy="0  -0.8  0" xyz="0.798 -0.125  0.478"/>
      <geometry>
        <box size="0.129 0.1 0.05"/>
      </geometry>
    </collision>
    <collision name="central_hump4_collision">
      <origin rpy="0  0  0" xyz="0.8135 -0.05    0.45"/>
      <geometry>
        <box size="0.10 0.05 0.1835"/>
      </geometry>
    </collision>
    <collision name="central_hump5_collision">
      <origin rpy="0  0  0" xyz="0.84  -0.125  0.45"/>
      <geometry>
        <box size="0.03 0.1 0.1835"/>
      </geometry>
    </collision>
    <collision name="central_hump6_collision">
      <origin rpy="0  0  0" xyz="0.82  -0.125  0.475"/>
      <geometry>
        <box size="0.03 0.1 0.05"/>
      </geometry>
    </collision>
    <visual name="visual">
      <origin rpy="0       0      -1.57079" xyz="0  0  0"/>
      <geometry>
        <mesh filename="package://ATV_description/models/polaris_ranger_xp900_no_roll_cage/meshes/polariss.dae"/>
      </geometry>
    </visual>
    <visual name="central_hump1">
      <origin rpy="0  0  0" xyz="0.55 -0.1   0.4"/>
      <geometry>
        <box size="0.6 0.15 0.1"/>
      </geometry>
    </visual>
    <visual name="central_hump2">
      <origin rpy="0  -0.5  0" xyz="0.7  -0.05  0.45"/>
      <geometry>
        <box size="0.20 0.05 0.1"/>
      </geometry>
    </visual>
    <visual name="central_hump3">
      <origin rpy="0  -0.8  0" xyz="0.798 -0.125  0.478"/>
      <geometry>
        <box size="0.129 0.1 0.05"/>
      </geometry>
    </visual>
    <visual name="central_hump4">
      <origin rpy="0  0  0" xyz="0.8135 -0.05    0.45"/>
      <geometry>
        <box size="0.10 0.05 0.1835"/>
      </geometry>
    </visual>
    <visual name="central_hump5">
      <origin rpy="0  0  0" xyz="0.84  -0.125  0.45"/>
      <geometry>
        <box size="0.03 0.1 0.1835"/>
      </geometry>
    </visual>
    <visual name="central_hump6">
      <origin rpy="0  0  0" xyz="0.82  -0.125  0.475"/>
      <geometry>
        <box size="0.03 0.1 0.05"/>
      </geometry>
    </visual>
  </link>
  <link name="left_front_wheel">
    <inertial>
      <mass value="12"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="0.5" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.2794" radius="0.3175"/>
      </geometry>
    </collision>
    <visual name="tire_visual">
      <origin rpy="3.14159  1.57079  0" xyz="0  0  0"/>
      <geometry>
        <mesh filename="package://ATV_description/models/polaris_ranger_xp900_no_roll_cage/meshes/right_wheel.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </visual>
  </link>
  <link name="right_front_wheel">
    <inertial>
      <mass value="12"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="0.5" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.2794" radius="0.3175"/>
      </geometry>
    </collision>
    <visual name="visual">
      <origin rpy="0      -1.57079  0" xyz="0  0  0"/>
      <geometry>
        <mesh filename="package://ATV_description/models/polaris_ranger_xp900_no_roll_cage/meshes/right_wheel.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </visual>
  </link>
  <link name="left_rear_wheel">
    <inertial>
      <mass value="12"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="0.5" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.2794" radius="0.3175"/>
      </geometry>
    </collision>
    <visual name="visual">
      <origin rpy="0      -1.57079  0" xyz="0  0  0"/>
      <geometry>
        <mesh filename="package://ATV_description/models/polaris_ranger_xp900_no_roll_cage/meshes/right_wheel.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </visual>
  </link>
  <link name="right_rear_wheel">
    <inertial>
      <mass value="12"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="0.5" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.2794" radius="0.3175"/>
      </geometry>
    </collision>
    <visual name="visual">
      <origin rpy="0      -1.57079  0" xyz="0  0  0"/>
      <geometry>
        <mesh filename="package://ATV_description/models/polaris_ranger_xp900_no_roll_cage/meshes/right_wheel.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </visual>
  </link>
  <link name="fr_steering_block">
    <inertial>
      <mass value="1"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.01" radius="0.05"/>
      </geometry>
    </collision>
  </link>
  <link name="fl_steering_block">
    <inertial>
      <mass value="1"/>
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <collision name="collision">
      <origin rpy="0  0  0" xyz="0  0  0"/>
      <geometry>
        <cylinder length="0.01" radius="0.05"/>
      </geometry>
    </collision>
  </link>
  <!--<link name="steering_wheel">
    <inertial>
      <mass value="1.0"/>
      <origin rpy="0  0  0" xyz="-0.002  0     0"/>
      <inertia ixx="0.012" ixy="0" ixz="0" iyy="0.012" iyz="0" izz="0.024"/>
    </inertial>
    <collision name="collision">
      <origin rpy="-0.6108   0      -1.57079" xyz="-0.03     0      -0.12082"/>
      <geometry>
        <mesh filename="package://meshes/polaris.dae OR meshes/polaris.dae OR meshes/polaris.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </collision>
    <visual name="visual">
      <origin rpy="-0.6108   0      -1.57079" xyz="-0.03     0      -0.12082"/>
      <geometry>
        <mesh filename="package://meshes/polaris.dae OR meshes/polaris.dae OR meshes/polaris.dae" scale="1.0 1.0 1.0"/>
      </geometry>
    </visual>
  </link>-->


  <gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
      <robotNamespace>/ATV</robotNamespace>
      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
    </plugin>
  </gazebo>

  <transmission name="right_steering_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="right_steering_joint">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="right_steering_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <transmission name="left_steering_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="left_steering_joint">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="left_steering_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <transmission name="right_rear_axle_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="right_rear_axle">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="right_rear_axle_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <transmission name="left_rear_axle_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="left_rear_axle">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="left_rear_axle_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <transmission name="right_front_axle_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="right_front_axle">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="right_front_axle_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <transmission name="left_front_axle_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="left_front_axle">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="left_front_axle_act">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <joint name="laser_joint" type="fixed">
    <parent link="chassis"/>
    <child link="laser_frame"/>
    <origin xyz="1.3 0 0.9" rpy="0 0 0"/>
  </joint>

  <link name="laser_frame">
    <visual>
        <geometry>
            <cylinder radius="0.05" length="0.04"/>
        </geometry>
        <material name="red"/>
    </visual>
    <collision>
        <geometry>
            <cylinder radius="0.05" length="0.04"/>
        </geometry>
    </collision>
    <cylinder mass="0.1" length="0.04" radius="0.05">
        <origin xyz="0 0 0" rpy="0 0 0"/>
    </cylinder>
  </link>

    <gazebo reference="laser_frame">
      <sensor type="gpu_ray" name="head_hokuyo_sensor">
        <pose>0 0 0 0 0 0</pose>
        <visualize>true</visualize>
        <update_rate>40</update_rate>
        <ray>
          <scan>
            <horizontal>
              <samples>720</samples>
              <resolution>1</resolution>
              <min_angle>-1.570796</min_angle>
              <max_angle>1.570796</max_angle>
            </horizontal>
          </scan>
          <range>
            <min>0.10</min>
            <max>30.0</max>
            <resolution>0.01</resolution>
          </range>
          <noise>
            <type>gaussian</type>
            <!-- Noise parameters based on published spec for Hokuyo laser
                achieving "+-30mm" accuracy at range < 10m.  A mean of 0.0m and
                stddev of 0.01m will put 99.7% of samples within 0.03m of the true
                reading. -->
            <mean>0.0</mean>
            <stddev>0.01</stddev>
          </noise>
        </ray>
        <plugin name="gazebo_ros_head_hokuyo_controller" filename="libgazebo_ros_gpu_laser.so">
          <topicName>/sensors/laser/scan</topicName>
          <frameName>chassis</frameName>
        </plugin>
      </sensor>
    </gazebo>



  <joint name="imu_joint" type="fixed">
    <parent link="chassis"/>
    <child link="imu_frame"/>
    <origin xyz="0.1 0 0.9" rpy="0 0 0"/>
  </joint>

  <link name="imu_frame">
    <visual>
        <geometry>
            <box size="0.06 0.06 0.03"/>
        </geometry>
        <material name="blue"/>
    </visual>
    <collision>
        <geometry>
            <box size="0.06 0.06 0.03"/>
        </geometry>
    </collision>
    <cylinder mass="0.1" length="0.04" radius="0.05">
        <origin xyz="0 0 0" rpy="0 0 0"/>
    </cylinder>
  </link>

    <gazebo reference="imu_frame">
    <gravity>true</gravity>
    <sensor name="imu_sensor" type="imu">
      <always_on>true</always_on>
      <update_rate>100</update_rate>
      <visualize>true</visualize>
      <topic>/sensors/imu</topic>
      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">
        <topicName>imu</topicName>
        <bodyName>imu_frame</bodyName>
        <updateRateHZ>10.0</updateRateHZ>
        <gaussianNoise>0.0</gaussianNoise>
        <xyzOffset>0 0 0</xyzOffset>
        <rpyOffset>0 0 0</rpyOffset>
        <frameName>imu_frame</frameName>
        <initialOrientationAsReference>false</initialOrientationAsReference>
      </plugin>
      <pose>0 0 0 0 0 0</pose>
    </sensor>
  </gazebo>


  <joint name="kinect_joint" type="fixed">
    <parent link="chassis"/>
    <child link="kinect_frame"/>
    <origin xyz="1.3 0 1" rpy="0 0 0"/>
  </joint>

  <link name="kinect_frame">
    <visual>
        <geometry>
            <box size="0.03 0.07 0.03"/>
        </geometry>
        <material name="blue"/>
    </visual>
    <collision>
        <geometry>
            <box size="0.06 0.06 0.03"/>
        </geometry>
    </collision>
    <cylinder mass="0.1" length="0.04" radius="0.05">
        <origin xyz="0 0 0" rpy="0 0 0"/>
    </cylinder>
  </link>

  <gazebo reference="kinect_frame">
  <sensor name="kinect_camera" type="depth">
    <update_rate>20</update_rate>
    <camera>
      <horizontal_fov>1.047198</horizontal_fov>
      <image>
        <!--<width>640</width>
        <height>480</height>-->
        <width>1280</width>
        <height>960</height>
        <format>R8G8B8</format>
      </image>
      <clip>
        <near>0.05</near>
        <far>3</far>
      </clip>
    </camera>
    <plugin name="kinect_controller" filename="libgazebo_ros_openni_kinect.so">
      <baseline>0.2</baseline>
      <alwaysOn>true</alwaysOn>
      <updateRate>1.0</updateRate>
      <visualize>true</visualize>
      <cameraName>kinect_ir</cameraName>
      <imageTopicName>/kinect/color/image_raw</imageTopicName>
      <cameraInfoTopicName>/kinect/color/camera_info</cameraInfoTopicName>
      <depthImageTopicName>/kinect/depth/image_raw</depthImageTopicName>
      <depthImageInfoTopicName>/kinect/depth/camera_info</depthImageInfoTopicName>
      <pointCloudTopicName>/kinect/depth/points</pointCloudTopicName>
      <frameName>kinect_frame</frameName>
      <pointCloudCutoff>0.5</pointCloudCutoff>
      <pointCloudCutoffMax>3.0</pointCloudCutoffMax>
      <distortionK1>0.00000001</distortionK1>
      <distortionK2>0.00000001</distortionK2>
      <distortionK3>0.00000001</distortionK3>
      <distortionT1>0.00000001</distortionT1>
      <distortionT2>0.00000001</distortionT2>
      <CxPrime>0</CxPrime>
      <Cx>0</Cx>
      <Cy>0</Cy>
      <focalLength>0</focalLength>
      <hackBaseline>0</hackBaseline>
    </plugin>
  </sensor>
</gazebo>

    
</robot>
